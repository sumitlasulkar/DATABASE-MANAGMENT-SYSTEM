PL/SQL

ðŸ”¹ Definition

PL/SQL (Procedural Language/SQL) â†’ Oracleâ€™s procedural extension of SQL that allows writing programs with logic, loops, conditions, and variables along with SQL.
Combines SQL + procedural constructs.
Enables modular programming with blocks, procedures, functions, and packages.

ðŸ”¹ Features
Block structure â†’ Code is written in blocks (DECLARE, BEGIN, EXCEPTION, END).
Procedural constructs â†’ Supports IF, LOOP, WHILE, etc.
Variables & constants â†’ Can store temporary data.
Exception handling â†’ Catch runtime errors.
Procedures & Functions â†’ Reusable modules.
Triggers â†’ Automatic execution on table events.
Packages â†’ Group related procedures, functions, and variables.

ðŸ”¹ PL/SQL Block Structure


DECLARE
    "declare variables here"
    v_name VARCHAR2(50);
BEGIN
    "executable statements"
    v_name := 'Amit';
    DBMS_OUTPUT.PUT_LINE('Student Name: ' || v_name);
EXCEPTION
    "handle exceptions here"
    WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('Error occurred!');
END;


ðŸ”¹ Key Points
PL/SQL is block-structured: DECLARE â†’ BEGIN â†’ EXCEPTION â†’ END.
Supports SQL statements inside procedural code.
Enables error handling and modular programming.
Can create stored procedures, functions, triggers, and packages.
Output is usually printed using DBMS_OUTPUT.PUT_LINE.


ðŸ”¹ PL/SQL Data Type
PL/SQL Data Types â†’ Specifies the type of data a variable can store in PL/SQL.
Similar to SQL but includes procedural types for variables, constants, and records.

ðŸ”¹ Categories of PL/SQL Data Types
Scalar Data Types â†’ Store single values.
    NUMBER â†’ numeric values (integer, decimal)
    VARCHAR2(size) â†’ variable-length character strings
    CHAR(size) â†’ fixed-length character strings
    BOOLEAN â†’ TRUE, FALSE, NULL
    DATE â†’ stores date and time
Composite Data Types â†’ Store multiple values together.
    RECORD â†’ collection of different fields (like struct)
    TABLE / VARRAY / Nested Table â†’ collection of elements
Reference Data Types â†’ Store pointers or references.
    REF CURSOR â†’ pointer to query result set
LOB Data Types â†’ Store large objects.
    BLOB â†’ Binary Large Object
    CLOB â†’ Character Large Object
    NCLOB â†’ National Character LOB

ðŸ”¹ 1. %TYPE Attribute
Definition:
%TYPE allows you to declare a variable with the same data type as a column in a table.
Automatically inherits the columnâ€™s type and size, so you donâ€™t have to hardcode it.

ðŸ”¹ 2. %ROWTYPE Attribute
Definition:
%ROWTYPE allows you to declare a variable that can hold an entire row of a table or cursor.
Automatically inherits all columns and their data types.

ðŸ”¹ Control Structures
 â†’ Allow you to control the flow of execution in PL/SQL programs, similar to other programming languages.
They include:
Conditional Statements â†’ Make decisions (IFâ€¦THENâ€¦ELSE).
Loops â†’ Repeat statements (LOOP, WHILE, FOR).
Sequential Control â†’ Exit loops early (EXIT) or skip iterations.

ðŸ”¹ CASE statement
CASE statement â†’ Conditional expression that returns a value based on conditions, similar to IF-ELSE but more compact.
Can be used inside SELECT or PL/SQL blocks.
Two types:
Simple CASE â†’ Compare expression to values.
Searched CASE â†’ Evaluate multiple Boolean conditions.

ðŸ”¹Stored Procedure
 â†’ A named PL/SQL block stored in the database that can be executed multiple times.
Improves reusability and performance.
Can accept parameters (IN, OUT, IN OUT).
Can include SQL statements, loops, conditions, and exception handling.
Stored procedures are precompiled PL/SQL blocks.
Can accept parameters:
IN â†’ input value
OUT â†’ output value
IN OUT â†’ both input and output
Can include SQL statements, loops, conditionals, and exception handling.
Improves code reusability, modularity, and performance.

ðŸ”¹PL/SQL Function
 â†’ A named PL/SQL block that performs a task and returns a single value.
Unlike procedures, functions must return a value.
Can accept parameters (IN only).
Can be used in SQL statements or PL/SQL blocks.
Functions must return a value using RETURN.
Can accept IN parameters only (no OUT).
Can be called from SQL queries or PL/SQL blocks.
Useful for calculations, formatting, and reusable logic.



ðŸ”¹Cursor
Cursor â†’ A pointer that holds the result set of a query and allows row-by-row processing in PL/SQL.
Implicit cursors â†’ automatically created for simple queries (e.g., SELECT INTO).
Explicit cursors â†’ declared by the programmer for multi-row queries.
Cursors allow processing multi-row query results row by row.
%NOTFOUND â†’ returns TRUE when no more rows are left.
%ROWCOUNT â†’ number of rows fethed so far.
Always OPEN â†’ FETCH â†’ CLOSE for explicit cursors.
Implicit cursors are simpler for single-row queries.


ðŸ”¹ Triggers in PL/SQL
Definition:
A trigger is a stored PL/SQL block that automatically executes in response to events on a table or view.

ðŸ”¹ Types of Triggers
Before Trigger â†’ Executes before an INSERT, UPDATE, or DELETE operation.
After Trigger â†’ Executes after an INSERT, UPDATE, or DELETE operation.
Instead Of Trigger â†’ Used on views to perform DML operations.
Row-Level Trigger â†’ Executes once for each affected row.
Statement-Level Trigger â†’ Executes once per SQL statement, regardless of affected rows.

âœ… Explanation

Before Insert Trigger â†’ modifies data before itâ€™s inserted.
After Insert Trigger â†’ executes after row insertion.
Before Update Trigger â†’ validates data before updating.
Statement-Level Trigger â†’ executes once per SQL statement, not per row.
Instead Of Trigger â†’ allows DML operations on a view.


ðŸ”¹ Exception Handling
Exception Handling â†’ Mechanism to catch and handle runtime errors in PL/SQL programs.
Helps prevent program termination due to errors.
Errors can be predefined (system exceptions) or user-defined.
ðŸ”¹ Types of Exceptions
Predefined Exceptions â†’ Automatically raised by Oracle (e.g., NO_DATA_FOUND, TOO_MANY_ROWS, ZERO_DIVIDE).
User-Defined Exceptions â†’ Declared by programmer using EXCEPTION.
Named Exceptions â†’ Explicitly declared and raised using RAISE.
Others â†’ Caught using WHEN OTHERS clause.


ðŸ”¹ Assertion
Assertion â†’ A condition that must always be true at a particular point in a PL/SQL program.
If the assertion fails, PL/SQL raises an exception.
Helps validate data or logic in the program.
ðŸ”¹ Types of Assertions
Compile-time assertions â†’ Checked before program execution.
Run-time assertions â†’ Checked during program execution using conditions and exceptions.
Note: PL/SQL does not have a built-in ASSERT keyword like some other languages, but assertions can be implemented using IF conditions + RAISE_APPLICATION_ERROR.
âœ… Explanation
Assertion check â†’ IF v_age < 0 THEN ...
Raise exception â†’ RAISE_APPLICATION_ERROR to indicate failure.
Exception handling â†’ WHEN OTHERS catches and prints the error.
This approach simulates assertions in PL/SQL.

ðŸ”¹Privileges
 â†’ Rights given to a user to perform specific actions on database objects.
Examples: SELECT, INSERT, UPDATE, DELETE, EXECUTE.
Roles â†’ A collection of privileges that can be granted to users to simplify privilege management.
ðŸ”¹ Types of Privileges
    1. System Privileges
    Allow a user to perform specific operations on the database itself.
    Examples: CREATE TABLE, CREATE VIEW, CREATE USER, DROP USER.
    2. Object Privileges
    Allow a user to perform actions on specific database objects.
    Examples: SELECT, INSERT, UPDATE, DELETE on a table or view.
    3. Roles
    Group of system and object privileges.
    Can be granted to multiple users at once.